In Windows FS register always points to _KPCR in Kernel Mode
============================================================

KERNEL AND HAL ANALYSIS
-----------------------------------------------------------------------------
1. GET FS REGISTER VALUE
-----------------------------------------------------------------------------
kd> r
eax=00000001 ebx=00018730 ecx=842ed9c8 edx=00000000 esi=8293ed20 edi=82940654
eip=82874d00 esp=8293bb84 ebp=8293bbb8 iopl=0         nv up ei pl nz na po nc
cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00000202
nt!RtlpBreakWithStatusInstruction:
82874d00 cc              int     3


FS REGISTER = 0030
-----------------------------------------------------------------------------

-----------------------------------------------------------------------------
2. Display KGDT_R0_PCR segment. Offset FS + 0x30. PCR=Processor Control Region
-----------------------------------------------------------------------------
kd> dg 0x30
                                  P Si Gr Pr Lo
Sel    Base     Limit     Type    l ze an es ng Flags
---- -------- -------- ---------- - -- -- -- -- --------
0030 8293ec00 00003748 Data RW Ac 0 Bg By P  Nl 00000493

KERNEL PROCESSOR CONTROL REGION: _KPCR = 8293ec00
-----------------------------------------------------------------------------


-----------------------------------------------------------------------------
3. Display _KPCR structure  
-----------------------------------------------------------------------------
kd> dt nt!_KPCR 8293ec00
   +0x000 NtTib            : _NT_TIB
   +0x000 Used_ExceptionList : 0x8293b32c _EXCEPTION_REGISTRATION_RECORD
   +0x004 Used_StackBase   : (null) 
   +0x008 Spare2           : (null) 
   +0x00c TssCopy          : 0x801c6000 Void
   +0x010 ContextSwitches  : 0x21447
   +0x014 SetMemberCopy    : 1
   +0x018 Used_Self        : (null) 
   +0x01c SelfPcr          : 0x8293ec00 _KPCR
   +0x020 Prcb             : 0x8293ed20 _KPRCB
   +0x024 Irql             : 0x1f ''
   +0x028 IRR              : 4
   +0x02c IrrActive        : 0
   +0x030 IDR              : 0xffff20f8
   +0x034 KdVersionBlock   : 0x8293dc00 Void
   +0x038 IDT              : 0x80b95400 _KIDTENTRY
   +0x03c GDT              : 0x80b95000 _KGDTENTRY
   +0x040 TSS              : 0x801c6000 _KTSS
   +0x044 MajorVersion     : 1
   +0x046 MinorVersion     : 1
   +0x048 SetMember        : 1
   +0x04c StallScaleFactor : 0x64
   +0x050 SpareUnused      : 0 ''
   +0x051 Number           : 0 ''
   +0x052 Spare0           : 0 ''
   +0x053 SecondLevelCacheAssociativity : 0 ''
   +0x054 VdmAlert         : 0
   +0x058 KernelReserved   : [14] 0
   +0x090 SecondLevelCacheSize : 0
   +0x094 HalReserved      : [16] 0
   +0x0d4 InterruptMode    : 0
   +0x0d8 Spare1           : 0 ''
   +0x0dc KernelReserved2  : [17] 0
   +0x120 PrcbData         : _KPRCB

KERNEL PROCESSOR CONTROL BLOCK DATA: +0x120 PrcbData         : _KPRCB
-----------------------------------------------------------------------------


-----------------------------------------------------------------------------
4. Display _KPRCB structure  
-----------------------------------------------------------------------------
kd> dt nt!_KPRCB 8293ec00+0x120
   +0x000 MinorVersion     : 1
   +0x002 MajorVersion     : 1
   +0x004 CurrentThread    : 0x82948340 _KTHREAD
   +0x008 NextThread       : (null) 
   +0x00c IdleThread       : 0x82948340 _KTHREAD
   +0x010 LegacyNumber     : 0 ''
   +0x011 NestingLevel     : 0x1 ''
   +0x012 BuildType        : 0
   +0x014 CpuType          : 6 ''
   +0x015 CpuID            : 1 ''
   +0x016 CpuStep          : 0x2a07
   +0x016 CpuStepping      : 0x7 ''
   +0x017 CpuModel         : 0x2a '*'
   +0x018 ProcessorState   : _KPROCESSOR_STATE
   +0x338 KernelReserved   : [16] 0
   +0x378 HalReserved      : [16] 0
   +0x3b8 CFlushSize       : 0x40
   +0x3bc CoresPerPhysicalProcessor : 0x1 ''
   +0x3bd LogicalProcessorsPerCore : 0x1 ''
   +0x3be PrcbPad0         : [2]  ""
   +0x3c0 MHz              : 0x88c
   +0x3c4 CpuVendor        : 0x1 ''
   +0x3c5 GroupIndex       : 0 ''
   +0x3c6 Group            : 0
   +0x3c8 GroupSetMember   : 1
   +0x3cc Number           : 0
   +0x3d0 PrcbPad1         : [72]  ""
   +0x418 LockQueue        : [17] _KSPIN_LOCK_QUEUE
   +0x4a0 NpxThread        : (null) 
   +0x4a4 InterruptCount   : 0xa8cb
   +0x4a8 KernelTime       : 0x6dcd
   +0x4ac UserTime         : 0x323
   +0x4b0 DpcTime          : 0xe5
   +0x4b4 DpcTimeCount     : 0
   +0x4b8 InterruptTime    : 0x56
   +0x4bc AdjustDpcThreshold : 8
   +0x4c0 PageColor        : 0x25cb
   +0x4c4 DebuggerSavedIRQL : 0x1c ''
   +0x4c5 NodeColor        : 0 ''
   +0x4c6 PrcbPad20        : [2]  ""
   +0x4c8 NodeShiftedColor : 0
   +0x4cc ParentNode       : 0x829482c0 _KNODE
   +0x4d0 SecondaryColorMask : 0x3f
   +0x4d4 DpcTimeLimit     : 0x3e7
   +0x4d8 PrcbPad21        : [2] 0
   +0x4e0 CcFastReadNoWait : 0
   +0x4e4 CcFastReadWait   : 0x145e
   +0x4e8 CcFastReadNotPossible : 0
   +0x4ec CcCopyReadNoWait : 0
   +0x4f0 CcCopyReadWait   : 0x18e3
   +0x4f4 CcCopyReadNoWaitMiss : 0
   +0x4f8 MmSpinLockOrdering : 0n0
   +0x4fc IoReadOperationCount : 0n8583
   +0x500 IoWriteOperationCount : 0n5346
   +0x504 IoOtherOperationCount : 0n75496
   +0x508 IoReadTransferCount : _LARGE_INTEGER 0x8a095ce
   +0x510 IoWriteTransferCount : _LARGE_INTEGER 0xbe871b
   +0x518 IoOtherTransferCount : _LARGE_INTEGER 0x491299
   +0x520 CcFastMdlReadNoWait : 0
   +0x524 CcFastMdlReadWait : 0
   +0x528 CcFastMdlReadNotPossible : 0
   +0x52c CcMapDataNoWait  : 0
   +0x530 CcMapDataWait    : 0x9365
   +0x534 CcPinMappedDataCount : 0xcb8
   +0x538 CcPinReadNoWait  : 0
   +0x53c CcPinReadWait    : 0x6a5
   +0x540 CcMdlReadNoWait  : 0
   +0x544 CcMdlReadWait    : 4
   +0x548 CcLazyWriteHotSpots : 0xe
   +0x54c CcLazyWriteIos   : 0x15d
   +0x550 CcLazyWritePages : 0x534
   +0x554 CcDataFlushes    : 0x3f9
   +0x558 CcDataPages      : 0x921
   +0x55c CcLostDelayedWrites : 0
   +0x560 CcFastReadResourceMiss : 0
   +0x564 CcCopyReadWaitMiss : 0x1ea0
   +0x568 CcFastMdlReadResourceMiss : 0
   +0x56c CcMapDataNoWaitMiss : 0
   +0x570 CcMapDataWaitMiss : 0xd1c
   +0x574 CcPinReadNoWaitMiss : 0
   +0x578 CcPinReadWaitMiss : 0x37
   +0x57c CcMdlReadNoWaitMiss : 0
   +0x580 CcMdlReadWaitMiss : 0
   +0x584 CcReadAheadIos   : 0xd0d
   +0x588 KeAlignmentFixupCount : 0
   +0x58c KeExceptionDispatchCount : 0x18f1
   +0x590 KeSystemCalls    : 0x1653e1
   +0x594 AvailableTime    : 0x1e9
   +0x598 PrcbPad22        : [2] 0
   +0x5a0 PPLookasideList  : [16] _PP_LOOKASIDE_LIST
   +0x620 PPNPagedLookasideList : [32] _GENERAL_LOOKASIDE_POOL
   +0xf20 PPPagedLookasideList : [32] _GENERAL_LOOKASIDE_POOL
   +0x1820 PacketBarrier    : 0
   +0x1824 ReverseStall     : 0n2
   +0x1828 IpiFrame         : (null) 
   +0x182c PrcbPad3         : [52]  ""
   +0x1860 CurrentPacket    : [3] (null) 
   +0x186c TargetSet        : 0
   +0x1870 WorkerRoutine    : (null) 
   +0x1874 IpiFrozen        : 0
   +0x1878 PrcbPad4         : [40]  ""
   +0x18a0 RequestSummary   : 0
   +0x18a4 SignalDone       : (null) 
   +0x18a8 PrcbPad50        : [56]  ""
   +0x18e0 DpcData          : [2] _KDPC_DATA
   +0x1908 DpcStack         : 0x80d8b000 Void
   +0x190c MaximumDpcQueueDepth : 0n4
   +0x1910 DpcRequestRate   : 0
   +0x1914 MinimumDpcRate   : 3
   +0x1918 DpcLastCount     : 0x31c8
   +0x191c PrcbLock         : 0
   +0x1920 DpcGate          : _KGATE
   +0x1930 ThreadDpcEnable  : 0x1 ''
   +0x1931 QuantumEnd       : 0 ''
   +0x1932 DpcRoutineActive : 0 ''
   +0x1933 IdleSchedule     : 0 ''
   +0x1934 DpcRequestSummary : 0n8
   +0x1934 DpcRequestSlot   : [2] 0n8
   +0x1934 NormalDpcState   : 0n8
   +0x1936 DpcThreadActive  : 0y0
   +0x1936 ThreadDpcState   : 0n0
   +0x1938 TimerHand        : 0x70f0
   +0x193c LastTick         : 0x70f0
   +0x1940 MasterOffset     : 0n78320
   +0x1944 PrcbPad41        : [2] 0
   +0x194c PeriodicCount    : 0
   +0x1950 PeriodicBias     : 0
   +0x1958 TickOffset       : 0x5540
   +0x1960 TimerTable       : _KTIMER_TABLE
   +0x31a0 CallDpc          : _KDPC
   +0x31c0 ClockKeepAlive   : 0n1
   +0x31c4 ClockCheckSlot   : 0 ''
   +0x31c5 ClockPollCycle   : 0x8 ''
   +0x31c6 PrcbPad6         : [2]  ""
   +0x31c8 DpcWatchdogPeriod : 0n2996
   +0x31cc DpcWatchdogCount : 0n2641
   +0x31d0 ThreadWatchdogPeriod : 0n0
   +0x31d4 ThreadWatchdogCount : 0n0
   +0x31d8 KeSpinLockOrdering : 0n0
   +0x31dc PrcbPad70        : [1] 0
   +0x31e0 WaitListHead     : _LIST_ENTRY [ 0x858920a4 - 0x842e3dbc ]
   +0x31e8 WaitLock         : 0
   +0x31ec ReadySummary     : 0
   +0x31f0 QueueIndex       : 1
   +0x31f4 DeferredReadyListHead : _SINGLE_LIST_ENTRY
   +0x31f8 StartCycles      : 0x94`1a6e837a
   +0x3200 CycleTime        : 0x5`3f81f3c4
   +0x3208 HighCycleTime    : 5
   +0x320c PrcbPad71        : 0
   +0x3210 PrcbPad72        : [2] 0
   +0x3220 DispatcherReadyListHead : [32] _LIST_ENTRY [ 0x82941f40 - 0x82941f40 ]
   +0x3320 ChainedInterruptList : (null) 
   +0x3324 LookasideIrpFloat : 0n2147483647
   +0x3328 MmPageFaultCount : 0n391425
   +0x332c MmCopyOnWriteCount : 0n5922
   +0x3330 MmTransitionCount : 0n113217
   +0x3334 MmCacheTransitionCount : 0n0
   +0x3338 MmDemandZeroCount : 0n244776
   +0x333c MmPageReadCount  : 0n56808
   +0x3340 MmPageReadIoCount : 0n13878
   +0x3344 MmCacheReadCount : 0n0
   +0x3348 MmCacheIoCount   : 0n0
   +0x334c MmDirtyPagesWriteCount : 0n35072
   +0x3350 MmDirtyWriteIoCount : 0n137
   +0x3354 MmMappedPagesWriteCount : 0n0
   +0x3358 MmMappedWriteIoCount : 0n0
   +0x335c CachedCommit     : 0xfc
   +0x3360 CachedResidentAvailable : 0xc7
   +0x3364 HyperPte         : 0x80c0000d Void
   +0x3368 PrcbPad8         : [4]  ""
   +0x336c VendorString     : [13]  "GenuineIntel"
   +0x3379 InitialApicId    : 0 ''
   +0x337a LogicalProcessorsPerPhysicalProcessor : 0x1 ''
   +0x337b PrcbPad9         : [5]  ""
   +0x3380 FeatureBits      : 0x808d3fff
   +0x3388 UpdateSignature  : _LARGE_INTEGER 0x0
   +0x3390 IsrTime          : 0
   +0x3398 RuntimeAccumulation : 0xac941240
   +0x33a0 PowerState       : _PROCESSOR_POWER_STATE
   +0x3468 DpcWatchdogDpc   : _KDPC
   +0x3488 DpcWatchdogTimer : _KTIMER
   +0x34b0 WheaInfo         : 0x842e8b98 Void
   +0x34b4 EtwSupport       : 0x84300940 Void
   +0x34b8 InterruptObjectPool : _SLIST_HEADER
   +0x34c0 HypercallPageList : _SLIST_HEADER
   +0x34c8 HypercallPageVirtual : (null) 
   +0x34cc VirtualApicAssist : (null) 
   +0x34d0 StatisticsPage   : (null) 
   +0x34d4 RateControl      : (null) 
   +0x34d8 Cache            : [5] _CACHE_DESCRIPTOR
   +0x3514 CacheCount       : 3
   +0x3518 CacheProcessorMask : [5] 1
   +0x352c PackageProcessorSet : _KAFFINITY_EX
   +0x3538 PrcbPad91        : [1] 0
   +0x353c CoreProcessorSet : 1
   +0x3540 TimerExpirationDpc : _KDPC
   +0x3560 SpinLockAcquireCount : 0x283f44
   +0x3564 SpinLockContentionCount : 0xb
   +0x3568 SpinLockSpinCount : 0
   +0x356c IpiSendRequestBroadcastCount : 0
   +0x3570 IpiSendRequestRoutineCount : 0
   +0x3574 IpiSendSoftwareInterruptCount : 0
   +0x3578 ExInitializeResourceCount : 0x5f38
   +0x357c ExReInitializeResourceCount : 0xbd5
   +0x3580 ExDeleteResourceCount : 0x4ed0
   +0x3584 ExecutiveResourceAcquiresCount : 0x1f57a2
   +0x3588 ExecutiveResourceContentionsCount : 0xb49
   +0x358c ExecutiveResourceReleaseExclusiveCount : 0xa2004
   +0x3590 ExecutiveResourceReleaseSharedCount : 0x153032
   +0x3594 ExecutiveResourceConvertsCount : 0x1e9
   +0x3598 ExAcqResExclusiveAttempts : 0xa0655
   +0x359c ExAcqResExclusiveAcquiresExclusive : 0x8bfd9
   +0x35a0 ExAcqResExclusiveAcquiresExclusiveRecursive : 0x14663
   +0x35a4 ExAcqResExclusiveWaits : 0x9af
   +0x35a8 ExAcqResExclusiveNotAcquires : 0x19
   +0x35ac ExAcqResSharedAttempts : 0x1539b7
   +0x35b0 ExAcqResSharedAcquiresExclusive : 0x22a5
   +0x35b4 ExAcqResSharedAcquiresShared : 0x14cd8f
   +0x35b8 ExAcqResSharedAcquiresSharedRecursive : 0x4982
   +0x35bc ExAcqResSharedWaits : 0x19a
   +0x35c0 ExAcqResSharedNotAcquires : 1
   +0x35c4 ExAcqResSharedStarveExclusiveAttempts : 0x17b0
   +0x35c8 ExAcqResSharedStarveExclusiveAcquiresExclusive : 1
   +0x35cc ExAcqResSharedStarveExclusiveAcquiresShared : 0x168d
   +0x35d0 ExAcqResSharedStarveExclusiveAcquiresSharedRecursive : 0x122
   +0x35d4 ExAcqResSharedStarveExclusiveWaits : 0
   +0x35d8 ExAcqResSharedStarveExclusiveNotAcquires : 0
   +0x35dc ExAcqResSharedWaitForExclusiveAttempts : 0
   +0x35e0 ExAcqResSharedWaitForExclusiveAcquiresExclusive : 0
   +0x35e4 ExAcqResSharedWaitForExclusiveAcquiresShared : 0
   +0x35e8 ExAcqResSharedWaitForExclusiveAcquiresSharedRecursive : 0
   +0x35ec ExAcqResSharedWaitForExclusiveWaits : 0
   +0x35f0 ExAcqResSharedWaitForExclusiveNotAcquires : 0
   +0x35f4 ExSetResOwnerPointerExclusive : 2
   +0x35f8 ExSetResOwnerPointerSharedNew : 0x9d
   +0x35fc ExSetResOwnerPointerSharedOld : 0x1d
   +0x3600 ExTryToAcqExclusiveAttempts : 0
   +0x3604 ExTryToAcqExclusiveAcquires : 0
   +0x3608 ExBoostExclusiveOwner : 2
   +0x360c ExBoostSharedOwners : 0
   +0x3610 ExEtwSynchTrackingNotificationsCount : 0
   +0x3614 ExEtwSynchTrackingNotificationsAccountedCount : 0
   +0x3618 Context          : 0x8293ed38 _CONTEXT
   +0x361c ContextFlags     : 0x10017
   +0x3620 ExtendedState    : 0x80d62000 _XSAVE_AREA


GET _KTHREAD: +0x004 CurrentThread    : 0x82948340 _KTHREAD
-----------------------------------------------------------------------------



-----------------------------------------------------------------------------
6. Display _KTHREAD structure  
-----------------------------------------------------------------------------
kd> dt nt!_KTHREAD 0x82948340
   +0x000 Header           : _DISPATCHER_HEADER
   +0x010 CycleTime        : 0x80`3f6fb726
   +0x018 HighCycleTime    : 0x80
   +0x020 QuantumTarget    : 0xfffffffe`384b28fe
   +0x028 InitialStack     : 0x8293bfd0 Void
   +0x02c StackLimit       : 0x82939000 Void
   +0x030 KernelStack      : 0x8293bd1c Void
   +0x034 ThreadLock       : 0
   +0x038 WaitRegister     : _KWAIT_STATUS_REGISTER
   +0x039 Running          : 0x1 ''
   +0x03a Alerted          : [2]  ""
   +0x03c KernelStackResident : 0y1
   +0x03c ReadyTransition  : 0y0
   +0x03c ProcessReadyQueue : 0y0
   +0x03c WaitNext         : 0y0
   +0x03c SystemAffinityActive : 0y0
   +0x03c Alertable        : 0y0
   +0x03c GdiFlushActive   : 0y0
   +0x03c UserStackWalkActive : 0y0
   +0x03c ApcInterruptRequest : 0y0
   +0x03c ForceDeferSchedule : 0y0
   +0x03c QuantumEndMigrate : 0y0
   +0x03c UmsDirectedSwitchEnable : 0y0
   +0x03c TimerActive      : 0y0
   +0x03c SystemThread     : 0y1
   +0x03c Reserved         : 0y000000000000000000 (0)
   +0x03c MiscFlags        : 0n8193
   +0x040 ApcState         : _KAPC_STATE
   +0x040 ApcStateFill     : [23]  "???"
   +0x057 Priority         : 0 ''
   +0x058 NextProcessor    : 0
   +0x05c DeferredProcessor : 0
   +0x060 ApcQueueLock     : 0
   +0x064 ContextSwitches  : 0x3a09
   +0x068 State            : 0x2 ''
   +0x069 NpxState         : 0 ''
   +0x06a WaitIrql         : 0x2 ''
   +0x06b WaitMode         : 0 ''
   +0x06c WaitStatus       : 0n0
   +0x070 WaitBlockList    : (null) 
   +0x074 WaitListEntry    : _LIST_ENTRY [ 0x0 - 0x0 ]
   +0x074 SwapListEntry    : _SINGLE_LIST_ENTRY
   +0x07c Queue            : (null) 
   +0x080 WaitTime         : 0
   +0x084 KernelApcDisable : 0n0
   +0x086 SpecialApcDisable : 0n0
   +0x084 CombinedApcDisable : 0
   +0x088 Teb              : (null) 
   +0x090 Timer            : _KTIMER
   +0x0b8 AutoAlignment    : 0y0
   +0x0b8 DisableBoost     : 0y0
   +0x0b8 EtwStackTraceApc1Inserted : 0y0
   +0x0b8 EtwStackTraceApc2Inserted : 0y0
   +0x0b8 CalloutActive    : 0y0
   +0x0b8 ApcQueueable     : 0y1
   +0x0b8 EnableStackSwap  : 0y1
   +0x0b8 GuiThread        : 0y0
   +0x0b8 UmsPerformingSyscall : 0y0
   +0x0b8 VdmSafe          : 0y0
   +0x0b8 UmsDispatched    : 0y0
   +0x0b8 ReservedFlags    : 0y000000000000000000000 (0)
   +0x0b8 ThreadFlags      : 0n96
   +0x0bc ServiceTable     : 0x8297c940 Void
   +0x0c0 WaitBlock        : [4] _KWAIT_BLOCK
   +0x120 QueueListEntry   : _LIST_ENTRY [ 0x0 - 0x0 ]
   +0x128 TrapFrame        : (null) 
   +0x12c FirstArgument    : (null) 
   +0x130 CallbackStack    : (null) 
   +0x130 CallbackDepth    : 0
   +0x134 ApcStateIndex    : 0x1 ''
   +0x135 BasePriority     : 0 ''
   +0x136 PriorityDecrement : 0 ''
   +0x136 ForegroundBoost  : 0y0000
   +0x136 UnusualBoost     : 0y0000
   +0x137 Preempted        : 0 ''
   +0x138 AdjustReason     : 0 ''
   +0x139 AdjustIncrement  : 0 ''
   +0x13a PreviousMode     : 0 ''
   +0x13b Saturation       : 0 ''
   +0x13c SystemCallNumber : 0
   +0x140 FreezeCount      : 0
   +0x144 UserAffinity     : _GROUP_AFFINITY
   +0x150 Process          : 0x82948600 _KPROCESS
   +0x154 Affinity         : _GROUP_AFFINITY
   +0x160 IdealProcessor   : 0
   +0x164 UserIdealProcessor : 0
   +0x168 ApcStatePointer  : [2] 0x829484b0 _KAPC_STATE
   +0x170 SavedApcState    : _KAPC_STATE
   +0x170 SavedApcStateFill : [23]  "???"
   +0x187 WaitReason       : 0 ''
   +0x188 SuspendCount     : 0 ''
   +0x189 Spare1           : 0 ''
   +0x18a OtherPlatformFill : 0 ''
   +0x18c Win32Thread      : (null) 
   +0x190 StackBase        : 0x8293c000 Void
   +0x194 SuspendApc       : _KAPC
   +0x194 SuspendApcFill0  : [1]  "???"
   +0x195 ResourceIndex    : 0 ''
   +0x194 SuspendApcFill1  : [3]  "???"
   +0x197 QuantumReset     : 0x7f ''
   +0x194 SuspendApcFill2  : [4]  "???"
   +0x198 KernelTime       : 0x6654
   +0x194 SuspendApcFill3  : [36]  "???"
   +0x1b8 WaitPrcb         : (null) 
   +0x194 SuspendApcFill4  : [40]  "???"
   +0x1bc LegoData         : (null) 
   +0x194 SuspendApcFill5  : [47]  "???"
   +0x1c3 LargeStack       : 0 ''
   +0x1c4 UserTime         : 0
   +0x1c8 SuspendSemaphore : _KSEMAPHORE
   +0x1c8 SuspendSemaphorefill : [20]  "???"
   +0x1dc SListFaultCount  : 0
   +0x1e0 ThreadListEntry  : _LIST_ENTRY [ 0x8294862c - 0x8294862c ]
   +0x1e8 MutantListHead   : _LIST_ENTRY [ 0x82948528 - 0x82948528 ]
   +0x1f0 SListFaultAddress : (null) 
   +0x1f4 ThreadCounters   : (null) 
   +0x1f8 XStateSave       : (null) 


GET _KAPC_STATE: +0x040 ApcState         : _KAPC_STATE
-----------------------------------------------------------------------------



-----------------------------------------------------------------------------
7. Display _KAPC_STATE structure  
-----------------------------------------------------------------------------
kd> dt nt!_KAPC_STATE 0x82948340+0x40
   +0x000 ApcListHead      : [2] _LIST_ENTRY [ 0x82948380 - 0x82948380 ]
   +0x010 Process          : 0x84233468 _KPROCESS
   +0x014 KernelApcInProgress : 0 ''
   +0x015 KernelApcPending : 0 ''
   +0x016 UserApcPending   : 0 ''


GET _KPROCESS: +0x010 Process          : 0x84233468 _KPROCESS
-----------------------------------------------------------------------------



-----------------------------------------------------------------------------
8. Get _KPROCESS structure. _KPROCESS is the first structure of _EPROCESS
-----------------------------------------------------------------------------
kd> dt nt!_EPROCESS 0x84233468 
   +0x000 Pcb              : _KPROCESS
   +0x098 ProcessLock      : _EX_PUSH_LOCK
   +0x0a0 CreateTime       : _LARGE_INTEGER 0x1cff354`57d8eb60
   +0x0a8 ExitTime         : _LARGE_INTEGER 0x0
   +0x0b0 RundownProtect   : _EX_RUNDOWN_REF
   +0x0b4 UniqueProcessId  : 0x00000004 Void
   +0x0b8 ActiveProcessLinks : _LIST_ENTRY [ 0x852019e0 - 0x829556d8 ]
   +0x0c0 ProcessQuotaUsage : [2] 0
   +0x0c8 ProcessQuotaPeak : [2] 0
   +0x0d0 CommitCharge     : 0xb
   +0x0d4 QuotaBlock       : 0x82949480 _EPROCESS_QUOTA_BLOCK
   +0x0d8 CpuQuotaBlock    : (null) 
   +0x0dc PeakVirtualSize  : 0x759000
   +0x0e0 VirtualSize      : 0x280000
   +0x0e4 SessionProcessLinks : _LIST_ENTRY [ 0x0 - 0x0 ]
   +0x0ec DebugPort        : (null) 
   +0x0f0 ExceptionPortData : (null) 
   +0x0f0 ExceptionPortValue : 0
   +0x0f0 ExceptionPortState : 0y000
   +0x0f4 ObjectTable      : 0x89001c98 _HANDLE_TABLE
   +0x0f8 Token            : _EX_FAST_REF
   +0x0fc WorkingSetPage   : 0
   +0x100 AddressCreationLock : _EX_PUSH_LOCK
   +0x104 RotateInProgress : (null) 
   +0x108 ForkInProgress   : (null) 
   +0x10c HardwareTrigger  : 0
   +0x110 PhysicalVadRoot  : 0x842e62e0 _MM_AVL_TABLE
   +0x114 CloneRoot        : (null) 
   +0x118 NumberOfPrivatePages : 4
   +0x11c NumberOfLockedPages : 0x40
   +0x120 Win32Process     : (null) 
   +0x124 Job              : (null) 
   +0x128 SectionObject    : (null) 
   +0x12c SectionBaseAddress : (null) 
   +0x130 Cookie           : 0
   +0x134 Spare8           : 0
   +0x138 WorkingSetWatch  : (null) 
   +0x13c Win32WindowStation : (null) 
   +0x140 InheritedFromUniqueProcessId : (null) 
   +0x144 LdtInformation   : (null) 
   +0x148 VdmObjects       : (null) 
   +0x14c ConsoleHostProcess : 0
   +0x150 DeviceMap        : 0x89008a38 Void
   +0x154 EtwDataSource    : (null) 
   +0x158 FreeTebHint      : 0x7ffe0000 Void
   +0x160 PageDirectoryPte : _HARDWARE_PTE
   +0x160 Filler           : 0
   +0x168 Session          : (null) 
   +0x16c ImageFileName    : [15]  "System"
   +0x17b PriorityClass    : 0x2 ''
   +0x17c JobLinks         : _LIST_ENTRY [ 0x0 - 0x0 ]
   +0x184 LockedPagesList  : (null) 
   +0x188 ThreadListHead   : _LIST_ENTRY [ 0x842d4288 - 0x85b8d690 ]
   +0x190 SecurityPort     : (null) 
   +0x194 PaeTop           : (null) 
   +0x198 ActiveThreads    : 0x56
   +0x19c ImagePathHash    : 0
   +0x1a0 DefaultHardErrorProcessing : 1
   +0x1a4 LastThreadExitStatus : 0n0
   +0x1a8 Peb              : (null) 
   +0x1ac PrefetchTrace    : _EX_FAST_REF
   +0x1b0 ReadOperationCount : _LARGE_INTEGER 0x8b
   +0x1b8 WriteOperationCount : _LARGE_INTEGER 0x6c
   +0x1c0 OtherOperationCount : _LARGE_INTEGER 0xc6e
   +0x1c8 ReadTransferCount : _LARGE_INTEGER 0x1770598
   +0x1d0 WriteTransferCount : _LARGE_INTEGER 0x5e1008
   +0x1d8 OtherTransferCount : _LARGE_INTEGER 0x3c42d
   +0x1e0 CommitChargeLimit : 0
   +0x1e4 CommitChargePeak : 0x2e
   +0x1e8 AweInfo          : (null) 
   +0x1ec SeAuditProcessCreationInfo : _SE_AUDIT_PROCESS_CREATION_INFO
   +0x1f0 Vm               : _MMSUPPORT
   +0x25c MmProcessLinks   : _LIST_ENTRY [ 0x85201b84 - 0x8294885c ]
   +0x264 HighestUserAddress : (null) 
   +0x268 ModifiedPageCount : 0x46cd
   +0x26c Flags2           : 0x2d800
   +0x26c JobNotReallyActive : 0y0
   +0x26c AccountingFolded : 0y0
   +0x26c NewProcessReported : 0y0
   +0x26c ExitProcessReported : 0y0
   +0x26c ReportCommitChanges : 0y0
   +0x26c LastReportMemory : 0y0
   +0x26c ReportPhysicalPageChanges : 0y0
   +0x26c HandleTableRundown : 0y0
   +0x26c NeedsHandleRundown : 0y0
   +0x26c RefTraceEnabled  : 0y0
   +0x26c NumaAware        : 0y0
   +0x26c ProtectedProcess : 0y1
   +0x26c DefaultPagePriority : 0y101
   +0x26c PrimaryTokenFrozen : 0y1
   +0x26c ProcessVerifierTarget : 0y0
   +0x26c StackRandomizationDisabled : 0y1
   +0x26c AffinityPermanent : 0y0
   +0x26c AffinityUpdateEnable : 0y0
   +0x26c PropagateNode    : 0y0
   +0x26c ExplicitAffinity : 0y0
   +0x270 Flags            : 0x14040800
   +0x270 CreateReported   : 0y0
   +0x270 NoDebugInherit   : 0y0
   +0x270 ProcessExiting   : 0y0
   +0x270 ProcessDelete    : 0y0
   +0x270 Wow64SplitPages  : 0y0
   +0x270 VmDeleted        : 0y0
   +0x270 OutswapEnabled   : 0y0
   +0x270 Outswapped       : 0y0
   +0x270 ForkFailed       : 0y0
   +0x270 Wow64VaSpace4Gb  : 0y0
   +0x270 AddressSpaceInitialized : 0y10
   +0x270 SetTimerResolution : 0y0
   +0x270 BreakOnTermination : 0y0
   +0x270 DeprioritizeViews : 0y0
   +0x270 WriteWatch       : 0y0
   +0x270 ProcessInSession : 0y0
   +0x270 OverrideAddressSpace : 0y0
   +0x270 HasAddressSpace  : 0y1
   +0x270 LaunchPrefetched : 0y0
   +0x270 InjectInpageErrors : 0y0
   +0x270 VmTopDown        : 0y0
   +0x270 ImageNotifyDone  : 0y0
   +0x270 PdeUpdateNeeded  : 0y0
   +0x270 VdmAllowed       : 0y0
   +0x270 CrossSessionCreate : 0y0
   +0x270 ProcessInserted  : 0y1
   +0x270 DefaultIoPriority : 0y010
   +0x270 ProcessSelfDelete : 0y0
   +0x270 SetTimerResolutionLink : 0y0
   +0x274 ExitStatus       : 0n259
   +0x278 VadRoot          : _MM_AVL_TABLE
   +0x298 AlpcContext      : _ALPC_PROCESS_CONTEXT
   +0x2a8 TimerResolutionLink : _LIST_ENTRY [ 0x0 - 0x0 ]
   +0x2b0 RequestedTimerResolution : 0
   +0x2b4 ActiveThreadsHighWatermark : 0x58
   +0x2b8 SmallestTimerResolution : 0
   +0x2bc TimerResolutionStackRecord : (null) 


GET TOKEN: +0x0f8 Token            : _EX_FAST_REF
-----------------------------------------------------------------------------


-----------------------------------------------------------------------------
9. Get TOKEN value from _EPROCESS
-----------------------------------------------------------------------------
kd> dd 0x84233468+f8 L1
84233560  890013e6


TOKEN: 890013e6
-----------------------------------------------------------------------------
