
struct s2 {
    signed char[12] pad12;
    uint32_t f12;
};

struct s1 {
    signed char[204] pad204;
    struct s2* f204;
    signed char[92] pad300;
    uint32_t f300;
};

struct s0 {
    uint32_t f0;
    signed char[4] pad8;
    struct s1* f8;
    signed char[10] pad22;
    unsigned char f22;
    signed char[73] pad96;
    int32_t f96;
};

/*
 * _xxxDDETrackSendHook@16
 * __stdcall xxxDDETrackSendHook(x,x,x,x)
 */
int32_t _xxxDDETrackSendHook_16(struct s0* a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);

int32_t gbfa1f6d8 = -1;

/*
 * _ValidateDDEConvPair@8
 * __stdcall ValidateDDEConvPair(x,x)
 */
int32_t _ValidateDDEConvPair_8(int32_t a1, struct s0* a2, int32_t a3);

struct s1* gbfa1eb58 = (struct s1*)0xffffffff;

/*
 * _xxxBroadcastMessage@28
 * __stdcall xxxBroadcastMessage(x,x,x,x,x,x,x)
 */
void _xxxBroadcastMessage_28(signed char a1);

/*
 * _xxxCallHook@16
 * __stdcall xxxCallHook(x,x,x,x)
 */
void _xxxCallHook_16(int32_t a1, int32_t a2, void* a3, ...);

/*
 * _xxxSendMessageToClient@28
 * __stdcall xxxSendMessageToClient(x,x,x,x,x,x,x)
 */
void _xxxSendMessageToClient_28(struct s0* a1, int32_t a2, int32_t a3, int32_t a4, int16_t a5);

/*
 * __FreeGestureInfo@8
 * __stdcall _FreeGestureInfo(x,x)
 */
void __FreeGestureInfo_8(int32_t a1, signed char a2);

/*
 * __FreeTouchInputInfo@8
 * __stdcall _FreeTouchInputInfo(x,x)
 */
void __FreeTouchInputInfo_8(int32_t a1, signed char a2);

int32_t gbf9f04bc;

int32_t gbfa1d1e8 = -1;

/*
 * _xxxDefWindowProc@16
 * __stdcall xxxDefWindowProc(x,x,x,x)
 */
void _xxxDefWindowProc_16(struct s0* a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);

/*
 * _xxxInterSendMsgEx@32
 * __stdcall xxxInterSendMsgEx(x,x,x,x,x,x,x,x)
 */
void _xxxInterSendMsgEx_32(struct s0* a1, int32_t a2, int32_t a3, int32_t a4, struct s1* a5, struct s1* a6, void* a7, void* a8, signed char a9);

/*
 * _IsThreadHung@8
 * __stdcall IsThreadHung(x,x)
 */
int32_t _IsThreadHung_8(struct s1* a1, signed char a2);

/*
 * _xxxSendMessageTimeout@32
 * __stdcall xxxSendMessageTimeout(x,x,x,x,x,x,x,x)
 */
void _xxxSendMessageTimeout_32(struct s0* a1, int32_t a2, int32_t a3, int32_t a4, uint32_t a5, int32_t a6, uint32_t* a7, void* a8) {
    uint128_t v2;
    void* ebp6;
    uint32_t* edi7;
    struct s0* esi8;
    uint96_t v9;
    int32_t ebx10;
    int32_t ebx11;
    int32_t eax12;
    int32_t eax13;
    int32_t eax14;
    struct s1* edi15;
    uint32_t eax16;
    uint40_t v17;
    uint64_t v18;
    uint32_t* eax19;
    void* v20;
    uint32_t eax21;
    uint32_t* ecx22;
    void* eax23;
    int32_t eax24;

    *(int32_t*)&v2 = a2;
    *((int32_t*)&v2 + 1) = a3;
    *((int32_t*)&v2 + 2) = a4;
    *((uint32_t*)&v2 + 3) = a5;
    ebp6 = (void*)((int32_t)"intrinsic"() - 4);
    edi7 = a7;
    if (edi7 != 0) {
        *edi7 = 0;
    }
    esi8 = a1;
    if (!(int1_t)(esi8 == -1)) {
        *(int32_t*)((int32_t)&v9 + 1) = ebx10;
        ebx11 = *(int32_t*)&v2;
        if ((uint32_t)(ebx11 + 0xfffffc20) <= 8) {
            eax12 = _xxxDDETrackSendHook_16(esi8, ebx11, *((int32_t*)&v2 + 1), *((int32_t*)&v2 + 2), *(int32_t*)((int32_t)&v9 + 1));
            if (eax12 == 0) 
                goto addr_0xbf8b94e1_6;
            if (ebx11 == 0x3e0 && (eax13 = gbfa1f6d8, eax13 != 0)) {
                if (edi7 == 0) {
                    a7 = (uint32_t*)ebp6 + 3;
                }
                *((uint32_t*)&v2 + 3) = *((uint32_t*)&v2 + 3) | 2;
                a6 = eax13;
            }
            eax14 = _ValidateDDEConvPair_8(*((int32_t*)&v2 + 1), esi8, *(int32_t*)((int32_t)&v9 + 1));
            if (eax14 != 0) {
                a8 = (void*)1;
            }
        }
        edi15 = gbfa1eb58;
        if (edi15 != esi8->f8) // crash ------------------> CRASH
            goto addr_0xbf8b9403_14;
    } else {
        if (edi7 != 0) {
        }
        _xxxBroadcastMessage_28(0);
        goto addr_0xbf8b9592_18;
    }
    eax16 = edi15->f204->f12 | edi15->f300;
    if ((*(unsigned char*)&eax16 & 32) != 0) {
        *(void**)&v17 = (void*)((int32_t)ebp6 + -20);
        *((int32_t*)&v18 + 1) = 0;
        *(int32_t*)&v18 = 0;
        *(int32_t*)((int32_t)&v18 + 1) = ebx11;
        *(int32_t*)((int32_t)&v17 + 1) = 0;
        _xxxCallHook_16(*(int32_t*)&v18, *((int32_t*)&v18 + 1), *(void**)&v17, *(int32_t*)&v18, *((int32_t*)&v18 + 1), *(void**)&v17);
    }
    *(void**)&v9 = (void*)((int32_t)ebp6 + 24);
    if ((esi8->f22 & 4) != 0) 
        goto addr_0xbf8b94ca_22;
    _xxxSendMessageToClient_28(esi8, ebx11, *((int32_t*)&v2 + 1), *((int32_t*)&v2 + 2), 0);
    if (((edi15->f204->f12 | edi15->f300) & 0x2000) != 0) {
        *(void**)((int32_t)&v9 + 5) = (void*)((int32_t)ebp6 + -24);
        _xxxCallHook_16(0, 0, *(void**)((int32_t)&v9 + 5), 0, 0, *(void**)((int32_t)&v9 + 5));
    }
    if ((uint32_t)(ebx11 + 0xfffffdc0) > 15) {
        if (ebx11 == 0x119) {
            __FreeGestureInfo_8(*((int32_t*)&v2 + 2), 1);
        }
    } else {
        __FreeTouchInputInfo_8(*((int32_t*)&v2 + 2), 1);
    }
    eax19 = a7;
    if (eax19 != 0) 
        goto addr_0xbf8b9588_30;
    goto addr_0xbf8b9591_32;
    addr_0xbf8b9588_30:
    *eax19 = *((uint32_t*)&v2 + 3);
    addr_0xbf8b958a_33:
    goto addr_0xbf8b9591_32;
    addr_0xbf8b94ca_22:
    v20 = (void*)((int32_t)ebp6 + 28);
    gbf9f04bc(v20, *(void**)&v9, *((signed char*)&v9 + 4));
    if ((uint32_t)((int32_t)ebp6 + 24 - a6) >= 0x1000) {
        eax21 = (uint32_t)esi8->f96(esi8, ebx11, *((int32_t*)&v2 + 1), *((int32_t*)&v2 + 2), v20, *(void**)&v9, *((signed char*)&v9 + 4));
        ecx22 = a7;
        if (ecx22 == 0) {
            addr_0xbf8b9591_32:
        } else {
            *ecx22 = eax21;
            goto addr_0xbf8b958a_33;
        }
    } else {
        addr_0xbf8b94e1_6:
        goto addr_0xbf8b9591_32;
    }
    addr_0xbf8b9592_18:
    return;
    addr_0xbf8b9403_14:
    eax23 = (void*)0;
    if ((*(unsigned char*)((esi8->f0 & 0xffff) * gbfa1d1e8 + 9) & 1) != 0) {
        _xxxDefWindowProc_16(esi8, ebx11, *((int32_t*)&v2 + 1), *((int32_t*)&v2 + 2), *(int32_t*)((int32_t)&v9 + 1));
        goto addr_0xbf8b9591_32;
    }
    if (a7 != 0) 
        goto addr_0xbf8b9439_38;
    addr_0xbf8b946d_39:
    _xxxInterSendMsgEx_32(esi8, ebx11, *((int32_t*)&v2 + 1), *((int32_t*)&v2 + 2), edi15, esi8->f8, eax23, a8, *((signed char*)&v9 + 4));
    goto addr_0xbf8b9591_32;
    addr_0xbf8b9439_38:
    if ((*((unsigned char*)&v2 + 12) & 2) == 0) 
        goto addr_0xbf8b9451_40;
    eax24 = _IsThreadHung_8(esi8->f8, 0);
    if (eax24 != 0) 
        goto addr_0xbf8b94e1_6;
    addr_0xbf8b9451_40:
    eax23 = (void*)((int32_t)ebp6 + -28);
    goto addr_0xbf8b946d_39;
}
